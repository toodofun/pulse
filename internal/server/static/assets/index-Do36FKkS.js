/**
 * Copyright 2025 The Toodofun Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http:www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import{r as u,I as g,R as o,h as D,e as R,j as a,B as $,D as M}from"./index-BpEXRqn4.js";import{m as d,A as O}from"./index-DpTnT3_U.js";import{P as C}from"./index-CM7Rwzna.js";import{R as S}from"./PlusOutlined-E8RtmBky.js";var I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},_={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function x(){return x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},x.apply(this,arguments)}const E=(e,t)=>u.createElement(g,x({},e,{ref:t,icon:I})),k=u.forwardRef(E);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},p.apply(this,arguments)}const A=(e,t)=>u.createElement(g,p({},e,{ref:t,icon:_})),U=u.forwardRef(A);var P=["second","minute","hour","day","week","month","year"];function z(e,t){if(t===0)return["just now","right now"];var n=P[Math.floor(t/2)];return e>1&&(n+="s"),[e+" "+n+" ago","in "+e+" "+n]}var B=["秒","分钟","小时","天","周","个月","年"];function T(e,t){if(t===0)return["刚刚","片刻后"];var n=B[~~(t/2)];return[e+" "+n+"前",e+" "+n+"后"]}var v={},j=function(e,t){v[e]=t},L=function(e){return v[e]||v.en_US},f=[60,60,24,7,365/7/12,12];function F(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function H(e,t){var n=e<0?1:0;e=Math.abs(e);for(var s=e,l=0;e>=f[l]&&l<f.length;l++)e/=f[l];return e=Math.floor(e),l*=2,e>(l===0?9:1)&&(l+=1),t(e,l,s)[n].replace("%s",e.toString())}function W(e,t){var n=new Date;return(+n-+F(e))/1e3}var m=function(e,t,n){var s=W(e);return H(s,L(t))};j("en_US",z);j("zh_CN",T);function Z(e){if(e<60)return`${e} s`;const t=Math.floor(e/60),n=e%60;return n===0?`${t} min`:`${t} min ${n} s`}const K=()=>{const[e,t]=o.useState(!0),[n,s]=o.useState(null),l=o.useRef(!1),i=D(),b=({monitor:r,onClick:y})=>{const N=[{label:a.jsx("div",{onClick:()=>{i(`/monitors/update/http/${r.id}`)},children:"Edit Monitor"}),key:"0"},{label:a.jsx("div",{onClick:async()=>{s(null),r.enabled?(await d.disable(r.id),i(0)):(await d.enable(r.id),i(0))},children:r.enabled?"Pause monitor":"Resume monitor"}),key:"1"},{type:"divider"},{label:a.jsx("div",{onClick:async()=>{s(null),await d.delete(r.id),i(0)},children:"Delete monitor"}),key:"3"}];return a.jsxs("div",{className:"bg-gray-800 flex items-center justify-between px-4 py-2 border border-gray-700 rounded-lg select-none cursor-pointer",onClick:y,children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(O,{type:r.enabled?r.isSuccess?"succeeded":"failed":"unknown",animation:r.enabled}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("div",{className:"text-sm",children:r.title}),a.jsxs("div",{className:"flex gap-2 text-xs text-slate-400",children:[a.jsx("div",{children:r.type.toUpperCase()}),a.jsx("div",{children:r.enabled?a.jsxs("div",{children:["Up ",m(r.createdAt)]}):a.jsxs("div",{children:["Disabled ",m(r.updatedAt)]})})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4 cursor-auto",onClick:c=>{c.preventDefault(),c.stopPropagation()},children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[a.jsx(U,{}),Z(r.interval)]}),a.jsx("div",{children:a.jsx(M,{menu:{items:N},trigger:["click"],open:n===r.id,onOpenChange:c=>{l.current=c,s(c?r.id:null)},children:a.jsx(k,{style:{color:"#90a1b9"}})})})]})]})},{data:w,run:h}=R(d.list,{loadingDelay:0,pollingInterval:5e3,refreshOnWindowFocus:!1,pollingWhenHidden:!1,onSuccess:()=>{t(!1)},ready:!l.current});return o.useEffect(()=>{if(!l.current&&!n){const r=setTimeout(()=>{h()},100);return()=>clearTimeout(r)}},[n,h]),a.jsxs("div",{className:"h-full w-full flex flex-col gap-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(C,{title:"Monitors"}),a.jsx($,{type:"primary",icon:a.jsx(S,{}),onClick:()=>{i("/monitors/new/http")},children:"新建"})]}),a.jsx("div",{className:"flex flex-col gap-3",children:e?a.jsx("div",{children:"loading"}):w?.map(r=>a.jsx(b,{monitor:r,onClick:()=>{i(`/monitors/${r.id}`)}},r.id))||a.jsx("div",{className:"text-gray-500",children:"No monitors available"})})]})};export{K as default};
