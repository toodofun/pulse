import{r as u,I as m,R as d,h as D,e as R,j as a,B as S,D as $}from"./index-CzvqyFm1.js";import{m as c,A as C}from"./index-Y_dV1kkX.js";import{P as O}from"./index-CiucK-wx.js";import{R as M}from"./PlusOutlined-HmiYeflv.js";var I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},v.apply(this,arguments)}const _=(e,t)=>u.createElement(m,v({},e,{ref:t,icon:I})),E=u.forwardRef(_);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},f.apply(this,arguments)}const A=(e,t)=>u.createElement(m,f({},e,{ref:t,icon:k})),U=u.forwardRef(A);var P=["second","minute","hour","day","week","month","year"];function z(e,t){if(t===0)return["just now","right now"];var r=P[Math.floor(t/2)];return e>1&&(r+="s"),[e+" "+r+" ago","in "+e+" "+r]}var B=["秒","分钟","小时","天","周","个月","年"];function T(e,t){if(t===0)return["刚刚","片刻后"];var r=B[~~(t/2)];return[e+" "+r+"前",e+" "+r+"后"]}var x={},j=function(e,t){x[e]=t},L=function(e){return x[e]||x.en_US},p=[60,60,24,7,365/7/12,12];function F(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function H(e,t){var r=e<0?1:0;e=Math.abs(e);for(var s=e,l=0;e>=p[l]&&l<p.length;l++)e/=p[l];return e=Math.floor(e),l*=2,e>(l===0?9:1)&&(l+=1),t(e,l,s)[r].replace("%s",e.toString())}function W(e,t){var r=new Date;return(+r-+F(e))/1e3}var g=function(e,t,r){var s=W(e);return H(s,L(t))};j("en_US",z);j("zh_CN",T);function Z(e){if(e<60)return`${e} s`;const t=Math.floor(e/60),r=e%60;return r===0?`${t} min`:`${t} min ${r} s`}const K=()=>{const[e,t]=d.useState(!0),[r,s]=d.useState(null),l=d.useRef(!1),i=D(),b=({monitor:n,onClick:y})=>{const N=[{label:a.jsx("div",{onClick:()=>{i(`/monitors/update/http/${n.id}`)},children:"Edit"}),key:"0"},{label:a.jsx("div",{onClick:async()=>{s(null),n.enabled?(await c.disable(n.id),i(0)):(await c.enable(n.id),i(0))},children:n.enabled?"Pause":"Resume"}),key:"1"},{label:a.jsx("div",{onClick:async()=>{s(null),n.private?(await c.public(n.id),i(0)):(await c.private(n.id),i(0))},children:n.private?"Set public":"Set private"}),key:"2"},{type:"divider"},{label:a.jsx("div",{onClick:async()=>{s(null),await c.delete(n.id),i(0)},children:"Delete monitor"}),key:"3"}];return a.jsxs("div",{className:"bg-gray-800 flex items-center justify-between px-4 py-2 border border-gray-700 rounded-lg select-none cursor-pointer",onClick:y,children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(C,{type:n.enabled?n.isSuccess?"succeeded":"failed":"unknown",animation:n.enabled}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("div",{className:"text-sm",children:n.title}),a.jsxs("div",{className:"flex gap-2 text-xs text-slate-400",children:[a.jsx("div",{children:n.type.toUpperCase()}),a.jsx("div",{children:n.enabled?a.jsxs("div",{children:["Up ",g(n.createdAt)]}):a.jsxs("div",{children:["Disabled ",g(n.updatedAt)]})})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4 cursor-auto",onClick:o=>{o.preventDefault(),o.stopPropagation()},children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[a.jsx(U,{}),Z(n.interval)]}),a.jsx("div",{children:a.jsx($,{menu:{items:N},trigger:["click"],open:r===n.id,onOpenChange:o=>{l.current=o,s(o?n.id:null)},children:a.jsx(E,{style:{color:"#90a1b9"}})})})]})]})},{data:w,run:h}=R(c.list,{loadingDelay:0,pollingInterval:5e3,refreshOnWindowFocus:!1,pollingWhenHidden:!1,onSuccess:()=>{t(!1)},ready:!l.current});return d.useEffect(()=>{if(!l.current&&!r){const n=setTimeout(()=>{h()},100);return()=>clearTimeout(n)}},[r,h]),a.jsxs("div",{className:"h-full w-full flex flex-col gap-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(O,{title:"Monitors"}),a.jsx(S,{type:"primary",icon:a.jsx(M,{}),onClick:()=>{i("/monitors/new/http")},children:"新建"})]}),a.jsx("div",{className:"flex flex-col gap-3",children:e?a.jsx("div",{children:"loading"}):w?.map(n=>a.jsx(b,{monitor:n,onClick:()=>{i(`/monitors/${n.id}`)}},n.id))||a.jsx("div",{className:"text-gray-500",children:"No monitors available"})})]})};export{K as default};
